(function(e){function t(){}function n(){}function r(e,t,n){if(e instanceof Array){for(var o,s=[],a=0,i=e.length;i>a;a++)o=r(e[a],t,n),e[a].tagName===l&&i-1>a&&e[a+1].tagName===u&&(a+=1,null==o&&(o=r(e[a].nodes,t,n))),null!=o&&(o instanceof Array?s=s.concat(o):s.push(o));return s}if(null!=e.content)return{content:e.content,type:e.type};if(e.tagName===l){var c=e.attr.id?t[e.attr.id]:n;return c?null==e.nodes?c:r(e.nodes,t,c):null}var d={tagName:e.tagName||e.compoName,attr:e.attr,type:e.type,controller:e.controller};return e.nodes&&(d.nodes=r(e.nodes,t,n)),d}function o(e,t){if(null==t&&(t={}),e instanceof Array){for(var n=e,r=0,a=n.length;a>r;r++)o(n[r],t);return t}var l=e.tagName;if(null!=l&&l===i){var u=e.attr.id;!u&&console.error("@content has no id specified",e),t[u]&&console.error("@content already exists",u),t[u]=s(e)}return null!=e.nodes&&o(e.nodes,t),t}function s(e){for(var t,n=e.parent;null!=n&&n.tagName!==c;){var r={type:n.type,tagName:n.tagName,attr:n.attr,controller:n.controller,nodes:null};null==t?(t=r,t.nodes=e.nodes):t.nodes=[r],n=n.parent}return null!=t?t:e.nodes}var a=e.mask,i="@content",l="@placeholder",u="@else",c="layout:view",d="layout:master",f={};t.prototype={constructor:t,render:function(){f[this.attr.id]=this}},a.registerHandler(d,t),n.prototype={constructor:n,renderStart:function(){var e=f[this.attr.master];return null==e?(console.error("Master Layout is not defined for",this),void 0):(null==this.contents&&(this.contents=o(this.nodes),Object.keys&&0===Object.keys(this.contents).length&&console.warn("no contents: @content #someID")),this.nodes=r(e,this.contents).nodes,void 0)}},a.registerHandler(c,n)})(this);